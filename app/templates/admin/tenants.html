{% extends "base.html" %}
{% block title %}Tenants | aiops Control Panel{% endblock %}
{% block content %}
<h1>Tenants</h1>
<form method="post">
  {{ form.hidden_tag() }}
  <label>
    {{ form.name.label }}
    {{ form.name() }}
    {% for error in form.name.errors %}
      <span class="error">{{ error }}</span>
    {% endfor %}
  </label>
  <label>
    {{ form.description.label }}
    {{ form.description(rows=3) }}
    {% for error in form.description.errors %}
      <span class="error">{{ error }}</span>
    {% endfor %}
  </label>
  <button type="submit">Add Tenant</button>
</form>

<h2>Existing Tenants</h2>
<div class="table-scroll">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Projects</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for tenant in tenants %}
      <tr>
        <td>{{ tenant.name }}</td>
        <td>{{ tenant.description or "â€”" }}</td>
        <td>{{ tenant.projects|length }}</td>
        <td>
          <form method="post" class="inline-form">
            {{ delete_form.csrf_token }}
            {{ delete_form.tenant_id(value=tenant.id) }}
            {{ delete_form.submit(
              class_="link-button danger",
              value="Remove",
              onclick="return confirm('Remove tenant {{ tenant.name }} and all related data?')"
            ) }}
          </form>
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4">No tenants yet.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
