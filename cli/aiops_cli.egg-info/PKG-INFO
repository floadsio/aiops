Metadata-Version: 2.4
Name: aiops-cli
Version: 0.3.0
Summary: Command-line interface for AIops REST API - manage issues, git operations, and AI workflows
Home-page: https://github.com/floadsio/aiops
Author: Floads.io
Author-email: ivo@floads.io
Project-URL: Bug Tracker, https://github.com/floadsio/aiops/issues
Project-URL: Documentation, https://github.com/floadsio/aiops#readme
Project-URL: Source Code, https://github.com/floadsio/aiops
Keywords: aiops cli devops automation git issues workflow
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: System Administrators
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: System :: Systems Administration
Classifier: Topic :: Utilities
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: click>=8.1
Requires-Dist: requests>=2.32
Requires-Dist: rich>=13.7
Requires-Dist: pydantic>=2.5
Requires-Dist: pyyaml>=6.0
Requires-Dist: python-dateutil>=2.8
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license-file
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# AIops CLI

A powerful command-line interface for interacting with the AIops REST API.

## Installation

```bash
pip install aiops-cli
```

Or install from source:

```bash
cd cli
pip install -e .
```

## Quick Start

1. **Configure your AIops server and API key:**

```bash
aiops config set url http://localhost:5000
aiops config set api_key aiops_your_api_key_here
```

2. **Test connection:**

```bash
aiops auth whoami
```

3. **List issues:**

```bash
aiops issues list
```

## Features

### Human-Readable Names Instead of IDs

The CLI supports using human-readable names instead of numeric IDs for projects and tenants across all commands:

```bash
# Use project names instead of IDs
aiops issues list --project aiops          # Instead of --project 1
aiops git status aiops                     # Instead of git status 1
aiops projects get aiops                   # Instead of projects get 1

# Use tenant slugs instead of IDs
aiops projects list --tenant example        # Instead of --tenant 1
aiops tenants get example                   # Instead of tenants get 1
```

- ✅ Case-insensitive matching
- ✅ Backward compatible with numeric IDs
- ✅ Clear error messages when name not found
- ✅ Works across all commands (issues, projects, git, tenants)

### Direct Issue-to-AI Workflow

Start working on an issue with a single command:

```bash
aiops issues work 123 --tool claude --attach
```

This automatically:
1. Claims the issue (assigns it to you)
2. Starts an AI session in tmux
3. Attaches you directly to the session

See the [Issues](#working-on-issues-with-ai) section for more details.

## Configuration

The CLI stores configuration in `~/.aiops/config.yaml`:

```yaml
url: http://localhost:5000
api_key: aiops_your_key_here
output_format: table  # or json, yaml
```

You can also set configuration via environment variables:
- `AIOPS_URL` - API base URL
- `AIOPS_API_KEY` - API key for authentication

## Commands

### Authentication

```bash
# Show current user
aiops auth whoami

# List your API keys
aiops auth keys list

# Create a new API key
aiops auth keys create --name "My Key" --scopes read write

# Revoke an API key
aiops auth keys delete <key-id>
```

### Issues

```bash
# List all issues
aiops issues list

# Filter issues
aiops issues list --status open --provider github --project 1

# Get issue details
aiops issues get 42

# Create an issue
aiops issues create --project 1 --integration 1 \\
  --title "Bug fix" --description "Fix authentication bug"

# Update issue
aiops issues update 42 --title "New title"

# Add comment
aiops issues comment 42 "Working on this"

# Close issue
aiops issues close 42

# Assign issue
aiops issues assign 42 --user 1

# Start an AI session to work on an issue (NEW!)
aiops issues work 42 --tool claude --attach
aiops issues work 123 --tool codex --prompt "Fix the authentication bug"
aiops issues work 456 --tool gemini
```

#### Working on Issues with AI

The `aiops issues work` command streamlines starting an AI coding session:

```bash
# Start a Claude session and attach to tmux immediately
aiops issues work 123 --tool claude --attach

# Start with an initial prompt
aiops issues work 456 --tool codex --prompt "Investigate the login timeout issue"

# Start session without attaching (can attach later via tmux)
aiops issues work 789 --tool gemini
```

**What it does:**
1. Claims the issue (assigns it to you)
2. Starts an AI tool session in tmux
3. Optionally attaches you directly to the interactive session

**Options:**
- `--tool {claude,codex,gemini}` - Choose which AI tool to use
- `--prompt "text"` - Send an initial prompt to the AI
- `--attach` - Automatically attach to the tmux session (interactive mode)

**Tmux controls:**
- Press `Ctrl+B` then `D` to detach from the session
- Reattach later with: `tmux attach -t <session-id>`

### Projects

```bash
# List projects
aiops projects list

# Filter by tenant (accepts tenant slug or ID)
aiops projects list --tenant example
aiops projects list --tenant 1

# Get project details (accepts project name or ID)
aiops projects get aiops
aiops projects get 1

# Create project (accepts tenant slug or ID)
aiops projects create --name "My Project" \\
  --tenant example --repo-url git@github.com:org/repo.git

# Get project status (accepts project name or ID)
aiops projects status aiops
aiops projects status 1
```

### Git Operations

All git commands accept project names or IDs:

```bash
# Get git status (accepts project name or ID)
aiops git status aiops
aiops git status 1

# Pull changes
aiops git pull aiops

# Push changes
aiops git push aiops

# List branches
aiops git branches aiops

# Create branch
aiops git branch aiops feature-xyz

# Checkout branch
aiops git checkout aiops main

# Commit changes
aiops git commit aiops "Fix bug" --files app/auth.py

# List files
aiops git files aiops

# Read file
aiops git cat aiops app/models.py
```

### Workflows (AI Agent Commands)

```bash
# Claim an issue for work
aiops workflow claim 42

# Update progress
aiops workflow progress 42 "in progress" --comment "Working on it"

# Submit changes
aiops workflow submit 42 --project 1 \\
  --message "Fix bug" --comment "Bug fixed"

# Request approval
aiops workflow approve 42 --message "Ready for review"

# Complete issue
aiops workflow complete 42 --summary "Bug fixed successfully"
```

### Tenants

```bash
# List tenants
aiops tenants list

# Get tenant details (accepts tenant slug or ID)
aiops tenants get example
aiops tenants get 1

# Create tenant
aiops tenants create --name "My Tenant" --description "Description"
```

### Configuration

```bash
# Show current configuration
aiops config show

# Set configuration values
aiops config set url http://localhost:5000
aiops config set api_key aiops_your_key

# Get configuration value
aiops config get url
```

## Output Formats

The CLI supports multiple output formats:

```bash
# Table format (default)
aiops issues list

# JSON format
aiops issues list --output json

# YAML format
aiops issues list --output yaml

# Set default format
aiops config set output_format json
```

## Examples

### Automated Workflow

```bash
#!/bin/bash
# Claim issue, fix bug, and submit

ISSUE_ID=42
PROJECT_ID=1

# Claim the issue
aiops workflow claim $ISSUE_ID

# Update status
aiops workflow progress $ISSUE_ID "in progress" \\
  --comment "Starting work on authentication bug"

# Make your code changes here...
# ...

# Commit changes
aiops git commit $PROJECT_ID "Fix authentication bug" \\
  --files app/auth.py app/models.py

# Submit changes
aiops workflow submit $ISSUE_ID --project $PROJECT_ID \\
  --message "Fix authentication bug" \\
  --comment "Fixed by updating token validation logic"

# Request review
aiops workflow approve $ISSUE_ID \\
  --message "Changes ready for review. All tests passing."

# After approval, complete the issue
aiops workflow complete $ISSUE_ID \\
  --summary "Authentication bug fixed and deployed"
```

### Batch Operations

```bash
# List all open issues and process them
aiops issues list --status open --output json | \\
  jq -r '.[].id' | \\
  while read issue_id; do
    echo "Processing issue $issue_id"
    aiops issues get $issue_id
  done
```

## Development

```bash
# Install in development mode
pip install -e ".[dev]"

# Run tests
pytest

# Format code
black aiops_cli/
ruff check --fix aiops_cli/
```

## License

MIT License - see LICENSE file for details.
